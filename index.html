<!DOCTYPE html>
<html lang="pt-br">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Lava Jato Ônix</title>

<style>

body{
font-family:Arial;
margin:0;
background:white;
}

header{

background:white;
padding:15px;
box-shadow:0 3px 10px rgba(0,0,0,0.2);
display:flex;
align-items:center;

}

.logo{
width:60px;
}

h1{
color:#c40000;
margin-left:10px;
}

.container{
padding:20px;
}

button{

background:#c40000;
color:white;
border:none;
padding:15px;
width:100%;
margin-top:10px;
border-radius:10px;

}

input{
width:100%;
padding:15px;
margin-top:10px;
}

.horas button{

width:30%;
margin:5px;

}

.card{

background:#eee;
padding:10px;
margin-top:10px;

}

.admin{

position:absolute;
right:20px;
top:20px;
font-size:25px;
cursor:pointer;

}

</style>

</head>

<body>

<header>

<img src="LAVA JATO.png" class="logo">

<h1>Lava Jato Ônix</h1>

</header>

<div class="admin" onclick="abrirAdmin()">⋮</div>

<div class="container">

<input id="nome" placeholder="Nome">

<input id="carro" placeholder="Carro">

<input id="fone" placeholder="Telefone">

<input type="date" id="data" onchange="gerarHoras()">

<div class="horas" id="horas"></div>

<button onclick="agendar()">AGENDAR</button>

<button onclick="abrirRemarcar()">REMARCAR</button>

<button onclick="excluir()">EXCLUIR</button>

<div id="agendaLista"></div>

</div>

<script>

senha="I8i82022@2023"

horarioSelecionado=""


function gerarHoras(){

horas.innerHTML=""

dataEscolhida=data.value

agenda=JSON.parse(localStorage.getItem("agenda")||"[]")

horarios=[
"08:00","08:30","09:00","09:30",
"10:00","10:30","11:00","11:30",
"12:00","12:30","13:00","13:30",
"14:00","14:30","15:00","15:30",
"16:00","16:30","17:00"
]


horarios.forEach(h=>{

bloqueado=false


agenda.forEach(a=>{

if(a.data==dataEscolhida){

dif=calcularDif(a.hora,h)

if(dif<150){

bloqueado=true

}

}

})


if(!bloqueado){

horas.innerHTML+=

`<button onclick="selecionarHora('${h}')">${h}</button>`

}

})

}


function calcularDif(h1,h2){

t1=converter(h1)

t2=converter(h2)

return Math.abs(t1-t2)

}


function converter(h){

p=h.split(":")

return p[0]*60+parseInt(p[1])

}


function selecionarHora(h){

horarioSelecionado=h

alert("Selecionado: "+h)

}


function agendar(){

if(horarioSelecionado==""){

alert("Escolha hora")

return

}


agenda=JSON.parse(localStorage.getItem("agenda")||"[]")


agenda.push({

nome:nome.value,

carro:carro.value,

fone:fone.value,

data:data.value,

hora:horarioSelecionado

})


localStorage.setItem("agenda",JSON.stringify(agenda))

alert("Agendado")

mostrar()

}


function mostrar(){

agenda=JSON.parse(localStorage.getItem("agenda")||"[]")

html=""

agenda.forEach(a=>{

html+=`

<div class="card">

Nome: ${a.nome}<br>
Carro: ${a.carro}<br>
Telefone: ${a.fone}<br>
Data: ${a.data}<br>
Hora: ${a.hora}

</div>

`

})

agendaLista.innerHTML=html

}

mostrar()


function excluir(){

n=prompt("nome")
c=prompt("carro")
d=prompt("data")
h=prompt("hora")

agenda=JSON.parse(localStorage.getItem("agenda")||"[]")

index=agenda.findIndex(a=>

a.nome==n &&
a.carro==c &&
a.data==d &&
a.hora==h

)

if(index==-1){

alert("erro")

return

}

agenda.splice(index,1)

localStorage.setItem("agenda",JSON.stringify(agenda))

mostrar()

}


function abrirRemarcar(){

n=prompt("nome")
c=prompt("carro")
d=prompt("data")
h=prompt("hora")


agenda=JSON.parse(localStorage.getItem("agenda")||"[]")


item=agenda.find(a=>

a.nome==n &&
a.carro==c &&
a.data==d &&
a.hora==h

)

if(!item){

alert("erro")

return

}


novaData=prompt("nova data")

item.data=novaData

localStorage.setItem("agenda",JSON.stringify(agenda))

gerarHoras()

alert("Escolha nova hora")

}


function abrirAdmin(){

s=prompt("Digite a senha")

if(s!=senha){

alert("Senha errada")

return

}

agenda=JSON.parse(localStorage.getItem("agenda")||"[]")

html=`

<h2>Painel Administrador</h2>

<input type="date" onchange="filtrarAdmin(this.value)">

<div id="adminLista"></div>

`

document.body.innerHTML+=html

mostrarAdmin()

}



function mostrarAdmin(){

agenda=JSON.parse(localStorage.getItem("agenda")||"[]")

html=""

agenda.forEach((a,i)=>{

html+=`

<div style="background:#eee;
padding:15px;
margin:10px;
border-radius:10px">

<b>Nome:</b> ${a.nome}<br>

<b>Carro:</b> ${a.carro}<br>

<b>Telefone:</b> ${a.fone}<br>

<b>Data:</b> ${a.data}<br>

<b>Hora:</b> ${a.hora}<br><br>


<button onclick="adminRemarcar(${i})">

Remarcar

</button>


<button onclick="adminExcluir(${i})">

Excluir

</button>

</div>

`

})

adminLista.innerHTML=html

}



function adminExcluir(i){

agenda=JSON.parse(localStorage.getItem("agenda")||"[]")

agenda.splice(i,1)

localStorage.setItem("agenda",JSON.stringify(agenda))

mostrarAdmin()

alert("Excluído")

}



function adminRemarcar(i){

agenda=JSON.parse(localStorage.getItem("agenda")||"[]")

novaData=prompt("Nova data")

novaHora=prompt("Nova hora")

agenda[i].data=novaData

agenda[i].hora=novaHora

localStorage.setItem("agenda",JSON.stringify(agenda))

mostrarAdmin()

alert("Remarcado")

}



function filtrarAdmin(data){

agenda=JSON.parse(localStorage.getItem("agenda")||"[]")

filtrado=agenda.filter(a=>a.data==data)

html=""

filtrado.forEach((a,i)=>{

html+=`

<div style="background:#eee;
padding:15px;
margin:10px;
border-radius:10px">

${a.nome} - ${a.hora}

</div>

`

})

adminLista.innerHTML=html

}

s=prompt("senha")

if(s!=senha){

alert("errado")

return

}


agenda=JSON.parse(localStorage.getItem("agenda")||"[]")

texto=""

agenda.forEach(a=>{

texto+=

`

Nome: ${a.nome}
Carro: ${a.carro}
Telefone: ${a.fone}
Data: ${a.data}
Hora: ${a.hora}

`

})


alert(texto)

}

</script>

</body>
</html>
