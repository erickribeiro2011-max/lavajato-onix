<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lava Jato Ã”nix</title>

<style>

body{
font-family:Arial;
margin:0;
background:white;
}

#intro{
position:fixed;
width:100%;
height:100%;
background:white;
display:flex;
flex-direction:column;
justify-content:center;
align-items:center;
z-index:9999;
transition:0.5s;
}

#intro img{
width:150px;
}

#intro h2{
color:#c40000;
}

header{
display:flex;
align-items:center;
padding:15px;
box-shadow:0 3px 10px rgba(0,0,0,0.2);
}

.logo{
width:60px;
}

h1{
color:#c40000;
margin-left:10px;
}

.container{
padding:20px;
}

input,button{
width:100%;
padding:15px;
margin-top:10px;
border-radius:10px;
border:1px solid #ccc;
font-size:16px;
}

button{
background:#c40000;
color:white;
border:none;
cursor:pointer;
}

.horas button{
width:30%;
margin:5px;
background:#eee;
color:black;
}

.horas button:hover{
background:#c40000;
color:white;
}

.card{
background:#eee;
padding:15px;
margin-top:10px;
border-radius:10px;
}

.admin{
position:absolute;
right:20px;
top:20px;
font-size:25px;
cursor:pointer;
}

.labelTitulo{
font-weight:bold;
margin-top:15px;
display:block;
color:#c40000;
font-size:18px;
}

</style>

</head>
<body>

<div id="intro">
<img src="LAVA JATO.png">
<h2>Bem vindo ao Lava Jato Ã”nix</h2>
</div>

<header>
<img src="LAVA JATO.png" class="logo">
<h1>Lava Jato Ã”nix</h1>
</header>

<div class="admin" onclick="abrirAdmin()">â‹®</div>

<div class="container">

<input id="nome" placeholder="Seu nome">
<input id="carro" placeholder="Seu carro">
<input id="fone" placeholder="Telefone">


<label class="labelTitulo">
ðŸ“… Selecione o dia do agendamento:
</label>

<input type="date" id="data" onchange="gerarHoras()">


<label class="labelTitulo">
ðŸ•’ Selecione o horÃ¡rio disponÃ­vel:
</label>

<div id="horas" class="horas"></div>


<button onclick="agendar()">AGENDAR</button>

<button onclick="remarcarCliente()">REMARCAR</button>

<button onclick="excluirCliente()">EXCLUIR</button>

<div id="lista"></div>

</div>

<script>

window.onload = function(){

setTimeout(()=>{

intro.style.opacity="0"

setTimeout(()=>{
intro.style.display="none"
},500)

},2000)

}

let senha="I8i82022@2023"
let horarioSelecionado=""

function gerarHoras(){

horas.innerHTML=""
horarioSelecionado=""

let agenda = JSON.parse(localStorage.getItem("agenda")||"[]")
let dataEscolhida=data.value

let horarios=[
"08:00","08:30","09:00","09:30",
"10:00","10:30","11:00","11:30",
"12:00","12:30","13:00","13:30",
"14:00","14:30","15:00","15:30",
"16:00","16:30","17:00"
]

horarios.forEach(h=>{

let bloqueado=false

agenda.forEach(a=>{

if(a.data==dataEscolhida){

let dif=Math.abs(converter(h)-converter(a.hora))

if(dif<150){
bloqueado=true
}

}

})

if(!bloqueado){

horas.innerHTML+=
`<button onclick="selecionarHora('${h}')">${h}</button>`

}

})

if(horas.innerHTML==""){
horas.innerHTML="<p>Sem horÃ¡rios disponÃ­veis</p>"
}

}

function converter(h){

let p=h.split(":")
return p[0]*60+parseInt(p[1])

}

function selecionarHora(h){

horarioSelecionado=h
alert("Selecionado: "+h)

}

function agendar(){

if(horarioSelecionado==""){
alert("Selecione um horÃ¡rio")
return
}

let agenda=JSON.parse(localStorage.getItem("agenda")||"[]")

agenda.push({

nome:nome.value,
carro:carro.value,
fone:fone.value,
data:data.value,
hora:horarioSelecionado

})

localStorage.setItem("agenda",JSON.stringify(agenda))

alert("Agendado com sucesso âœ…")

gerarHoras()

}

function excluirCliente(){

let n=prompt("Nome")
let c=prompt("Carro")
let d=prompt("Data")
let h=prompt("Hora")

let agenda=JSON.parse(localStorage.getItem("agenda")||"[]")

let index=agenda.findIndex(a=>
a.nome==n &&
a.carro==c &&
a.data==d &&
a.hora==h
)

if(index==-1){
alert("Dados incorretos")
return
}

agenda.splice(index,1)

localStorage.setItem("agenda",JSON.stringify(agenda))

alert("ExcluÃ­do")

gerarHoras()

}

function remarcarCliente(){

let n=prompt("Nome")
let c=prompt("Carro")
let d=prompt("Data")
let h=prompt("Hora")

let agenda=JSON.parse(localStorage.getItem("agenda")||"[]")

let item=agenda.find(a=>
a.nome==n &&
a.carro==c &&
a.data==d &&
a.hora==h
)

if(!item){
alert("Dados incorretos")
return
}

item.data=prompt("Nova data")
item.hora=prompt("Nova hora")

localStorage.setItem("agenda",JSON.stringify(agenda))

alert("Remarcado")

gerarHoras()

}

function abrirAdmin(){

let s=prompt("Senha")

if(s!=senha){
alert("Senha errada")
return
}

localStorage.setItem("admin","true")

let agenda=JSON.parse(localStorage.getItem("agenda")||"[]")

let html=""

agenda.forEach((a,i)=>{

html+=`

<div class="card">

Nome: ${a.nome}<br>
Carro: ${a.carro}<br>
Telefone: ${a.fone}<br>
Data: ${a.data}<br>
Hora: ${a.hora}<br><br>

<button onclick="adminRemarcar(${i})">
Remarcar
</button>

<button onclick="adminExcluir(${i})">
Excluir
</button>

</div>

`

})

lista.innerHTML=html

}

function adminExcluir(i){

let agenda=JSON.parse(localStorage.getItem("agenda")||"[]")

agenda.splice(i,1)

localStorage.setItem("agenda",JSON.stringify(agenda))

abrirAdmin()

}

function adminRemarcar(i){

let agenda=JSON.parse(localStorage.getItem("agenda")||"[]")

agenda[i].data=prompt("Nova data")
agenda[i].hora=prompt("Nova hora")

localStorage.setItem("agenda",JSON.stringify(agenda))

abrirAdmin()

}

window.onbeforeunload=function(){
localStorage.removeItem("admin")
}

</script>

</body>
</html>
